ARG FULLON_VERSION
ARG NODE_IMG_HEADER

# 使用Ubuntu基础镜像
FROM ${NODE_IMG_HEADER}fullon/funod:${FULLON_VERSION}

# 设置环境变量（按需调整CONTRACT_PATH）
ENV CONTRACT_PATH=/contract


# 安装系统依赖项
RUN apt update && \
    DEBIAN_FRONTEND=noninteractive apt install -y \
        libssl-dev \
        libboost-all-dev \
        libgmp3-dev \
        libbz2-dev \
        libreadline-dev \
        libncurses5-dev \
        libusb-1.0-0-dev \
        libudev-dev \
        libusb-dev \
        libusb-1.0-0 \
        libcurl4-gnutls-dev \
        cmake \
        g++ \
        libz3-dev 

# 复制flon.cdt的.deb包到镜像中
COPY /tmp/flon.cdt_*-alpha_amd64.deb /tmp/

# 安装flon.cdt包
RUN cd /tmp && apt-get update && apt-get install -y ./flon.cdt_*-alpha_amd64.deb

# 设置工作目录
WORKDIR $CONTRACT_PATH